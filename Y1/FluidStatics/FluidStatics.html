<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fluid Statics & Pressure - Interactive Lecture</title>

    <!-- External CSS -->
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="stylesheet" href="/assets/css/problems.css">
    <link rel="stylesheet" href="/assets/css/quizzes.css">
    <link rel="stylesheet" href="/assets/css/simulations.css">
    <link rel="stylesheet" href="/assets/css/uicontrols.css">

    <!-- MathJax for LaTeX equations -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-mml-chtml.js"></script>

    <!-- p5.js for interactive simulations -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
</head>

<body>
    <header>
        <h1>Fluid Statics & Pressure</h1>
        <p class="subtitle">Interactive Lecture & Simulation</p>
    </header>

    <!-- Section 1: Teaching Content -->
    <div class="content-section">
        <h2>Understanding Fluid Statics</h2>
        <p>Fluid statics, also known as hydrostatics, is the branch of fluid mechanics that studies fluids at rest. The fundamental principle is that pressure in a stationary fluid varies only with depth and is independent of the shape of the container.</p>

        <div class="key-point">
            <p><strong>Core Insight:</strong> Pressure at any point in a static fluid depends only on the vertical depth below the free surface. This principle explains why dams are thicker at the bottom and why submarines must withstand enormous pressure at great depths.</p>
        </div>

        <h3>Pressure Definition</h3>
        <p>Pressure is defined as the normal force per unit area exerted by a fluid on a surface:</p>

        <div class="equation-box">
            <p>\[p = \frac{F}{A}\]</p>
            <p>Where:</p>
            <ul>
                <li>\(p\) = Pressure (Pa or N/m²)</li>
                <li>\(F\) = Normal force (N)</li>
                <li>\(A\) = Area (m²)</li>
            </ul>
        </div>

        <h3>Hydrostatic Pressure</h3>
        <p>In a fluid at rest, pressure increases linearly with depth due to the weight of the fluid above:</p>

        <div class="equation-box">
            <p>\[p = p_0 + \rho g h\]</p>
            <p>Where:</p>
            <ul>
                <li>\(p\) = Absolute pressure at depth (Pa)</li>
                <li>\(p_0\) = Atmospheric pressure at surface (Pa) ≈ 101,325 Pa</li>
                <li>\(\rho\) = Fluid density (kg/m³)</li>
                <li>\(g\) = Gravitational acceleration (m/s²) ≈ 9.81 m/s²</li>
                <li>\(h\) = Depth below surface (m)</li>
            </ul>
        </div>

        <h3>Gauge Pressure vs Absolute Pressure</h3>
        <p>There are two common ways to express pressure:</p>
        <ul>
            <li><strong>Absolute Pressure:</strong> Measured relative to perfect vacuum (zero pressure)</li>
            <li><strong>Gauge Pressure:</strong> Measured relative to atmospheric pressure</li>
        </ul>

        <div class="equation-box">
            <p>\[p_{\text{absolute}} = p_{\text{gauge}} + p_{\text{atm}}\]</p>
            <p>\[p_{\text{gauge}} = \rho g h\]</p>
        </div>

        <h3>Pascal's Law</h3>
        <p>A pressure change at any point in a confined incompressible fluid is transmitted equally to all points in the fluid:</p>

        <div class="key-point">
            <p><strong>Pascal's Principle:</strong> This principle is the basis for hydraulic systems, where a small force applied over a small area creates a large force over a larger area.</p>
        </div>

        <div class="equation-box">
            <p>\[\frac{F_1}{A_1} = \frac{F_2}{A_2}\]</p>
            <p>Therefore: \[F_2 = F_1 \times \frac{A_2}{A_1}\]</p>
        </div>

        <h3>Pressure on Submerged Surfaces</h3>
        <p>The total force on a submerged planar surface is the product of the pressure at the centroid and the surface area:</p>

        <div class="equation-box">
            <p>\[F = p_c \times A = \rho g h_c \times A\]</p>
            <p>Where:</p>
            <ul>
                <li>\(h_c\) = Depth to centroid of surface (m)</li>
                <li>\(A\) = Surface area (m²)</li>
            </ul>
        </div>

        <h3>Buoyancy and Archimedes' Principle</h3>
        <p>When an object is immersed in a fluid, it experiences an upward buoyant force equal to the weight of the fluid displaced:</p>

        <div class="equation-box">
            <p>\[F_b = \rho_{\text{fluid}} g V_{\text{displaced}}\]</p>
            <p>Where:</p>
            <ul>
                <li>\(F_b\) = Buoyant force (N)</li>
                <li>\(V_{\text{displaced}}\) = Volume of fluid displaced (m³)</li>
            </ul>
        </div>
    </div>

    <!-- Section 2: Interactive Simulation -->
    <div class="simulation-container">
        <h2>Interactive Hinged Gate Equilibrium Problem</h2>
        <p>This simulation demonstrates the problem from the example: a hinged gate submerged in water with a horizontal force P applied. Adjust the parameters to see how the equilibrium changes and what minimum force P is required to prevent liquid leakage.</p>

        <!-- Control Panel -->
        <div class="controls-grid">
            <div class="slider-container">
                <label for="h1">Water depth h₁: <span id="h1-value" class="value-display">7.0</span> m</label>
                <input type="range" id="h1" min="3" max="10" value="7" step="0.5" class="slider">
            </div>

            <div class="slider-container">
                <label for="h2">Vertical wall height h₂: <span id="h2-value" class="value-display">5.0</span> m</label>
                <input type="range" id="h2" min="1" max="7" value="5" step="0.5" class="slider">
            </div>

            <div class="slider-container">
                <label for="l1">Horizontal plate length l₁: <span id="l1-value" class="value-display">2.5</span> m</label>
                <input type="range" id="l1" min="0.5" max="4.5" value="2.5" step="0.1" class="slider">
            </div>
        </div>

        <!-- Visualization Options -->
        <div class="controls-grid" style="margin-top: 15px; border-top: 1px solid #ddd; padding-top: 15px;">
            <div style="display: flex; gap: 20px; justify-content: center;">
                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                    <input type="checkbox" id="showVerticalPressure" checked>
                    <span>Show vertical wall pressure</span>
                </label>
                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                    <input type="checkbox" id="showHorizontalPressure" checked>
                    <span>Show horizontal plate pressure</span>
                </label>
            </div>
        </div>

        <!-- Canvas Holder -->
        <div id="sketch-holder"></div>

        <!-- Legend -->
        <div class="diagram-legend">
            <div class="legend-item">
                <div class="legend-color" style="background-color: rgba(0, 100, 255, 0.4);"></div>
                <span>Water</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: rgba(139, 90, 43, 1);"></div>
                <span>Gate Structure</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: rgba(255, 0, 0, 0.7);"></div>
                <span>Hydrostatic Forces (F₁, F₂)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: rgba(0, 200, 0, 1);"></div>
                <span>Applied Force (P)</span>
            </div>
        </div>
    </div>

    <!-- Section 3: Engineering Applications -->
    <div class="content-section">
        <h2>Engineering Applications</h2>
        <ul>
            <li><strong>Dam Design:</strong> Hydrostatic pressure calculations are critical for designing dams and retaining walls. The pressure increases linearly with depth, requiring dams to be thicker at the base to resist the enormous forces.</li>
            <li><strong>Submarine Design:</strong> Submarines must withstand crushing pressures at depth. At 300m depth, the pressure is approximately 30 atmospheres (3 MPa), requiring thick-walled pressure hulls made of high-strength steel or titanium.</li>
            <li><strong>Hydraulic Systems:</strong> Pascal's Law enables hydraulic jacks, brakes, and presses to multiply forces. A small input force on a small piston creates a large output force on a larger piston.</li>
            <li><strong>Water Supply Systems:</strong> Water towers use hydrostatic pressure to distribute water. The height of the tower determines the water pressure in the distribution system without the need for pumps.</li>
            <li><strong>Oil Storage Tanks:</strong> Large oil storage tanks must be designed to withstand the hydrostatic pressure of the stored fluid, especially at the base where pressure is maximum.</li>
        </ul>
    </div>

    <!-- Section 4: Summary of Key Equations -->
    <div class="content-section">
        <h2>Summary of Key Equations</h2>
        <div class="equation-table">
            <table>
                <thead>
                    <tr>
                        <th>Concept</th>
                        <th>Equation</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Pressure Definition</td>
                        <td>\(p = \frac{F}{A}\)</td>
                        <td>Force per unit area</td>
                    </tr>
                    <tr>
                        <td>Hydrostatic Pressure</td>
                        <td>\(p = p_0 + \rho g h\)</td>
                        <td>Pressure at depth h</td>
                    </tr>
                    <tr>
                        <td>Gauge Pressure</td>
                        <td>\(p_{\text{gauge}} = \rho g h\)</td>
                        <td>Pressure above atmospheric</td>
                    </tr>
                    <tr>
                        <td>Pascal's Law</td>
                        <td>\(\frac{F_1}{A_1} = \frac{F_2}{A_2}\)</td>
                        <td>Pressure transmission in fluids</td>
                    </tr>
                    <tr>
                        <td>Buoyant Force</td>
                        <td>\(F_b = \rho_f g V_d\)</td>
                        <td>Archimedes' Principle</td>
                    </tr>
                    <tr>
                        <td>Force on Surface</td>
                        <td>\(F = \rho g h_c A\)</td>
                        <td>Total force on submerged surface</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Section 5: Practice Problems -->
    <div class="content-section">
        <h2>Practice Problems</h2>

        <div class="practice-problems">
            <h3>Problem 1: Pressure in a Water Tank</h3>
            <p>A water tank is filled to a depth of 8 meters. Calculate the gauge pressure and absolute pressure at the bottom of the tank. Use \(\rho_{\text{water}} = 1000\) kg/m³, \(g = 9.81\) m/s², and \(p_{\text{atm}} = 101.325\) kPa.</p>

            <p class="toggle-section" onclick="toggleSolution('solution1')">Show Solution</p>
            <div id="solution1" class="hidden">
                <p><strong>Solution:</strong></p>
                <p><strong>Given:</strong></p>
                <ul>
                    <li>Depth: h = 8 m</li>
                    <li>Density: ρ = 1000 kg/m³</li>
                    <li>Gravity: g = 9.81 m/s²</li>
                    <li>Atmospheric pressure: p₀ = 101.325 kPa</li>
                </ul>

                <p><strong>Calculate Gauge Pressure:</strong></p>
                <p>\[p_{\text{gauge}} = \rho g h = 1000 \times 9.81 \times 8\]</p>
                <p>\[p_{\text{gauge}} = 78,480 \text{ Pa} = 78.48 \text{ kPa}\]</p>

                <p><strong>Calculate Absolute Pressure:</strong></p>
                <p>\[p_{\text{absolute}} = p_{\text{gauge}} + p_{\text{atm}}\]</p>
                <p>\[p_{\text{absolute}} = 78.48 + 101.325 = 179.805 \text{ kPa}\]</p>

                <p><strong>Answer:</strong> Gauge pressure = 78.48 kPa, Absolute pressure = 179.81 kPa</p>
            </div>
        </div>

        <div class="practice-problems">
            <h3>Problem 2: Hydraulic Lift</h3>
            <p>A hydraulic lift has a small piston with diameter 5 cm and a large piston with diameter 25 cm. If a force of 200 N is applied to the small piston, what force can be lifted on the large piston?</p>

            <p class="toggle-section" onclick="toggleSolution('solution2')">Show Solution</p>
            <div id="solution2" class="hidden">
                <p><strong>Solution:</strong></p>
                <p><strong>Given:</strong></p>
                <ul>
                    <li>Small piston diameter: d₁ = 5 cm = 0.05 m</li>
                    <li>Large piston diameter: d₂ = 25 cm = 0.25 m</li>
                    <li>Input force: F₁ = 200 N</li>
                </ul>

                <p><strong>Calculate Areas:</strong></p>
                <p>\[A_1 = \frac{\pi d_1^2}{4} = \frac{\pi (0.05)^2}{4} = 1.963 \times 10^{-3} \text{ m}^2\]</p>
                <p>\[A_2 = \frac{\pi d_2^2}{4} = \frac{\pi (0.25)^2}{4} = 4.909 \times 10^{-2} \text{ m}^2\]</p>

                <p><strong>Apply Pascal's Law:</strong></p>
                <p>\[F_2 = F_1 \times \frac{A_2}{A_1} = 200 \times \frac{4.909 \times 10^{-2}}{1.963 \times 10^{-3}}\]</p>
                <p>\[F_2 = 200 \times 25 = 5000 \text{ N} = 5 \text{ kN}\]</p>

                <p><strong>Answer:</strong> The hydraulic lift can lift a force of 5000 N (5 kN), which is 25 times the input force.</p>
            </div>
        </div>

        <div class="practice-problems">
            <h3>Problem 3: Buoyancy of a Cube</h3>
            <p>A solid cube with side length 0.5 m and density 800 kg/m³ is fully submerged in water (density 1000 kg/m³). Calculate the buoyant force and determine if the cube will float or sink.</p>

            <p class="toggle-section" onclick="toggleSolution('solution3')">Show Solution</p>
            <div id="solution3" class="hidden">
                <p><strong>Solution:</strong></p>
                <p><strong>Given:</strong></p>
                <ul>
                    <li>Cube side: a = 0.5 m</li>
                    <li>Cube density: ρ_cube = 800 kg/m³</li>
                    <li>Water density: ρ_water = 1000 kg/m³</li>
                </ul>

                <p><strong>Calculate Volume:</strong></p>
                <p>\[V = a^3 = (0.5)^3 = 0.125 \text{ m}^3\]</p>

                <p><strong>Calculate Weight of Cube:</strong></p>
                <p>\[W = \rho_{\text{cube}} g V = 800 \times 9.81 \times 0.125 = 981 \text{ N}\]</p>

                <p><strong>Calculate Buoyant Force:</strong></p>
                <p>\[F_b = \rho_{\text{water}} g V = 1000 \times 9.81 \times 0.125 = 1226.25 \text{ N}\]</p>

                <p><strong>Compare Forces:</strong></p>
                <p>Since \(F_b = 1226.25 \text{ N} > W = 981 \text{ N}\), the buoyant force exceeds the weight.</p>

                <p><strong>Answer:</strong> The buoyant force is 1226.25 N. Since this is greater than the weight, the cube will float.</p>
            </div>
        </div>
    </div>

    <!-- Section 6: Knowledge Check Quiz -->
    <div class="content-section">
        <h2>Knowledge Check Quiz</h2>
        <div class="quiz-container">
            <div class="quiz-question">
                <h3>Question 1: Gauge pressure is measured relative to:</h3>
                <div class="quiz-options">
                    <label><input type="radio" name="q1" value="a"> a) Perfect vacuum</label>
                    <label><input type="radio" name="q1" value="b"> b) Atmospheric pressure</label>
                    <label><input type="radio" name="q1" value="c"> c) The pressure at the bottom of a container</label>
                    <label><input type="radio" name="q1" value="d"> d) Sea level pressure</label>
                </div>
            </div>

            <div class="quiz-question">
                <h3>Question 2: In a static fluid, pressure increases with depth because:</h3>
                <div class="quiz-options">
                    <label><input type="radio" name="q2" value="a"> a) Fluids become denser with depth</label>
                    <label><input type="radio" name="q2" value="b"> b) Of the weight of the fluid above</label>
                    <label><input type="radio" name="q2" value="c"> c) Temperature decreases with depth</label>
                    <label><input type="radio" name="q2" value="d"> d) Viscosity increases with depth</label>
                </div>
            </div>

            <div class="quiz-question">
                <h3>Question 3: Pascal's Law states that:</h3>
                <div class="quiz-options">
                    <label><input type="radio" name="q3" value="a"> a) Pressure decreases exponentially with depth</label>
                    <label><input type="radio" name="q3" value="b"> b) Pressure change is transmitted equally throughout a confined fluid</label>
                    <label><input type="radio" name="q3" value="c"> c) Buoyant force equals weight of displaced fluid</label>
                    <label><input type="radio" name="q3" value="d"> d) Pressure depends on container shape</label>
                </div>
            </div>

            <div class="quiz-question">
                <h3>Question 4: If you double the depth in a fluid, the gauge pressure:</h3>
                <div class="quiz-options">
                    <label><input type="radio" name="q4" value="a"> a) Stays the same</label>
                    <label><input type="radio" name="q4" value="b"> b) Doubles</label>
                    <label><input type="radio" name="q4" value="c"> c) Quadruples</label>
                    <label><input type="radio" name="q4" value="d"> d) Increases exponentially</label>
                </div>
            </div>

            <div class="quiz-question">
                <h3>Question 5: An object will float in a fluid if:</h3>
                <div class="quiz-options">
                    <label><input type="radio" name="q5" value="a"> a) Its density is greater than the fluid</label>
                    <label><input type="radio" name="q5" value="b"> b) Its density is less than the fluid</label>
                    <label><input type="radio" name="q5" value="c"> c) Its volume is large</label>
                    <label><input type="radio" name="q5" value="d"> d) The buoyant force is zero</label>
                </div>
            </div>

            <button id="submit-quiz">Submit Quiz</button>
            <div id="quiz-results"></div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <script src="/assets/common/footer.js"></script>
    </footer>

    <!-- Common JavaScript Functions -->
    <script src="/assets/common/problems.js"></script>
    <script src="/assets/common/quizzes.js"></script>

    <!-- Page-specific JavaScript -->
    <script>
        // Hinged L-Gate Hydrostatic Force Simulation
        let sketch = new p5(function(p) {
            // Parameters - using var so sliders can modify them
            var h1 = 7.0; // total water depth (m)
            var h2 = 5.0; // vertical wall height of gate (m)
            var l1 = 2.5; // horizontal plate length (m)

            // Fixed parameters
            const b = 1.0; // width perpendicular to view (m) - fixed

            // Visualization options
            var showVerticalPressure = true;
            var showHorizontalPressure = true;

            // Constants
            const rho = 1000; // water density (kg/m³)
            const g = 9.81; // gravity (m/s²)
            const scale = 45; // pixels per meter

            // Visual constants
            const gateThickness = 12;
            const hingeX = 250;
            const hingeY = 120;

            p.setup = function() {
                let canvasWidth = Math.min(900, p.windowWidth - 40);
                p.createCanvas(canvasWidth, 600);
                setupControls();
            };

            p.draw = function() {
                p.background(250);

                // Calculate all forces
                let forces = calculateForces();

                // Draw in order: walls, water, gate, pressure distributions, forces, labels
                drawTankWalls();
                drawWater();
                drawGate();

                // Draw pressure distributions if enabled
                if (showVerticalPressure) {
                    drawVerticalPressure();
                }
                if (showHorizontalPressure) {
                    drawHorizontalPressure();
                }

                drawForces(forces);
                drawDimensions();
                drawInfoPanel(forces);
            };

            function calculateForces() {
                // F1: Hydrostatic force on vertical wall
                // Hinge C is at water surface (depth = 0)
                // Vertical wall extends h2 down from hinge
                // Gauge pressure varies linearly from 0 at hinge to rho*g*h2 at bottom
                let p_top = 0; // Gauge pressure at hinge (water surface)
                let p_bottom = rho * g * h2; // Gauge pressure at bottom of vertical wall
                let p_avg = (p_top + p_bottom) / 2;
                let F1 = p_avg * h2 * b / 1000; // kN
                let b1 = (2/3) * h2; // centroid of triangular distribution, 2/3 from hinge

                // F2: Hydrostatic force on horizontal plate
                // Horizontal plate is at depth h2 from water surface
                // Uniform gauge pressure = rho*g*h2
                let F2 = rho * g * h2 * l1 * b / 1000; // kN
                let b2 = l1 / 2; // centroid at geometric center

                // Calculate P for equilibrium: taking moments about hinge C
                // Clockwise: F1*b1 + F2*b2
                // Counter-clockwise: P*h2
                let P = (F1 * b1 + F2 * b2) / h2;

                return {
                    F1: F1,
                    F2: F2,
                    b1: b1,
                    b2: b2,
                    P: P
                };
            }

            function drawTankWalls() {
                // Tank boundaries - fixed tank width of 5m
                const tankWidth = 5.0; // meters
                let waterSurface = hingeY;
                let waterBottom = hingeY + h1 * scale;
                let leftWall = hingeX - tankWidth * scale;

                p.stroke(60);
                p.strokeWeight(8);
                p.noFill();

                // Left wall
                p.line(leftWall, waterSurface, leftWall, waterBottom);
                // Bottom wall
                p.line(leftWall, waterBottom, hingeX + 80, waterBottom);
                // Right wall
                p.line(hingeX, waterSurface, hingeX, waterBottom);
            }

            function drawWater() {
                const tankWidth = 5.0; // meters
                let waterSurface = hingeY;
                let waterBottom = hingeY + h1 * scale;
                let leftWall = hingeX - tankWidth * scale;
                let gateBottom = hingeY + h2 * scale;

                // Water region - enclosed by walls and gate
                p.fill(100, 180, 255, 120);
                p.noStroke();

                p.beginShape();
                p.vertex(leftWall, waterSurface);           // Top left
                p.vertex(hingeX - l1 * scale, waterSurface); // Free surface end
                p.vertex(hingeX - l1 * scale, gateBottom);  // Down gate horizontal plate
                p.vertex(hingeX, gateBottom);               // Across to vertical gate
                p.vertex(hingeX, waterBottom);              // Down right wall
                p.vertex(leftWall, waterBottom);            // Bottom left
                p.endShape(p.CLOSE);

                // Water surface waves
                p.noFill();
                p.stroke(20, 100, 200);
                p.strokeWeight(2);
                for (let x = leftWall; x < hingeX - l1 * scale; x += 8) {
                    let wave = p.sin(p.frameCount * 0.04 + x * 0.08) * 2;
                    p.line(x, waterSurface + wave, x + 8, waterSurface + wave);
                }

                // Label
                p.fill(0);
                p.noStroke();
                p.textSize(14);
                p.textAlign(p.CENTER);
                p.text("Water", leftWall + 50, waterSurface + h1 * scale / 2);
            }

            function drawGate() {
                let gateBottom = hingeY + h2 * scale;

                // Gate color
                p.fill(120, 80, 40);
                p.stroke(50);
                p.strokeWeight(3);

                // Vertical part (from hinge down)
                p.rect(hingeX - gateThickness/2, hingeY, gateThickness, h2 * scale);

                // Horizontal part (from bottom, extending left)
                p.rect(hingeX - l1 * scale, gateBottom - gateThickness/2, l1 * scale, gateThickness);

                // Hinge at C
                p.fill(40);
                p.noStroke();
                p.circle(hingeX, hingeY, 18);

                // Hinge cross
                p.stroke(255);
                p.strokeWeight(2);
                p.line(hingeX - 6, hingeY, hingeX + 6, hingeY);
                p.line(hingeX, hingeY - 6, hingeX, hingeY + 6);

                // Hinge label
                p.fill(0);
                p.noStroke();
                p.textSize(16);
                p.textAlign(p.LEFT);
                p.text("C", hingeX + 12, hingeY - 8);
            }

            function drawVerticalPressure() {
                // Draw linear pressure distribution on vertical wall (inside tank, left of gate)
                // Gauge pressure: 0 at hinge (water surface) to rho*g*h2 at bottom of vertical wall
                let p_top = 0; // Gauge pressure at hinge (water surface)
                let p_bottom = rho * g * h2 / 1000; // kPa - gauge pressure at bottom of vertical wall
                let gateBottom = hingeY + h2 * scale;
                let pressureScale = 0.6; // visual scaling factor (increased for clarity)

                // Draw the triangular pressure distribution
                p.fill(211, 47, 47, 100);
                p.stroke(211, 47, 47, 180);
                p.strokeWeight(2);

                p.beginShape();
                p.vertex(hingeX - gateThickness/2, hingeY); // Top of wall (inside tank)

                // Draw several points along the pressure distribution
                let numPoints = 10;
                for (let i = 0; i <= numPoints; i++) {
                    let fraction = i / numPoints;
                    let y = hingeY + fraction * h2 * scale;
                    let pressure = p_top + fraction * (p_bottom - p_top);
                    let x = hingeX - gateThickness/2 - pressure * pressureScale;
                    p.vertex(x, y);
                }

                p.vertex(hingeX - gateThickness/2, gateBottom); // Bottom of wall (inside tank)
                p.endShape(p.CLOSE);

                // Draw pressure arrows at several locations
                let numArrows = 6;
                for (let i = 0; i <= numArrows; i++) {
                    let fraction = i / numArrows;
                    let y = hingeY + fraction * h2 * scale;
                    let pressure = p_top + fraction * (p_bottom - p_top);
                    let arrowLen = pressure * pressureScale;

                    p.stroke(211, 47, 47, 180);
                    p.strokeWeight(1.5);
                    p.line(hingeX - gateThickness/2 - arrowLen, y,
                           hingeX - gateThickness/2, y);

                    // Small arrowhead pointing right (toward gate)
                    p.fill(211, 47, 47, 180);
                    p.noStroke();
                    let arrowSize = 4;
                    p.triangle(hingeX - gateThickness/2, y,
                              hingeX - gateThickness/2 - arrowSize, y - arrowSize*0.5,
                              hingeX - gateThickness/2 - arrowSize, y + arrowSize*0.5);
                }

                // Label
                p.fill(211, 47, 47);
                p.noStroke();
                p.textSize(11);
                p.textAlign(p.RIGHT);
                p.text("Linear pressure", hingeX - gateThickness/2 - p_bottom * pressureScale - 5, hingeY + h2 * scale / 2);
                p.text("distribution", hingeX - gateThickness/2 - p_bottom * pressureScale - 5, hingeY + h2 * scale / 2 + 13);
            }

            function drawHorizontalPressure() {
                // Draw constant pressure distribution on horizontal plate (above gate, inside tank)
                // Uniform gauge pressure at depth h2 below water surface
                let p_uniform = rho * g * h2 / 1000; // kPa - gauge pressure at the horizontal plate
                let gateBottom = hingeY + h2 * scale;
                let pressureScale = 0.6; // visual scaling factor (increased for clarity)

                // Draw the rectangular pressure distribution
                p.fill(211, 47, 47, 100);
                p.stroke(211, 47, 47, 180);
                p.strokeWeight(2);

                let arrowLen = p_uniform * pressureScale;

                p.beginShape();
                p.vertex(hingeX - l1 * scale, gateBottom - gateThickness/2); // Left end (above gate)
                p.vertex(hingeX, gateBottom - gateThickness/2); // Right end (at vertical wall)
                p.vertex(hingeX, gateBottom - gateThickness/2 - arrowLen); // Right end extended upward
                p.vertex(hingeX - l1 * scale, gateBottom - gateThickness/2 - arrowLen); // Left end extended upward
                p.endShape(p.CLOSE);

                // Draw pressure arrows at several locations
                let numArrows = 6;
                for (let i = 0; i <= numArrows; i++) {
                    let fraction = i / numArrows;
                    let x = hingeX - fraction * l1 * scale;

                    p.stroke(211, 47, 47, 180);
                    p.strokeWeight(1.5);
                    p.line(x, gateBottom - gateThickness/2 - arrowLen,
                           x, gateBottom - gateThickness/2);

                    // Small arrowhead pointing down (toward gate)
                    p.fill(211, 47, 47, 180);
                    p.noStroke();
                    let arrowSize = 4;
                    p.triangle(x, gateBottom - gateThickness/2,
                              x - arrowSize*0.5, gateBottom - gateThickness/2 - arrowSize,
                              x + arrowSize*0.5, gateBottom - gateThickness/2 - arrowSize);
                }

                // Label
                p.fill(211, 47, 47);
                p.noStroke();
                p.textSize(11);
                p.textAlign(p.CENTER);
                p.text("Uniform pressure", hingeX - l1 * scale / 2, gateBottom - gateThickness/2 - arrowLen - 10);
                p.text("distribution", hingeX - l1 * scale / 2, gateBottom - gateThickness/2 - arrowLen + 3);
            }

            function drawForces(forces) {
                let gateBottom = hingeY + h2 * scale;
                let forceScale = 0.15; // Increased from 0.025 for better visibility

                // F1 - Hydrostatic force on vertical wall (horizontal arrow pointing right)
                let F1_y = hingeY + forces.b1 * scale;
                let F1_len = forces.F1 * forceScale;

                drawArrow(hingeX + gateThickness/2 + 5, F1_y,
                         hingeX + gateThickness/2 + 5 + F1_len, F1_y, '#D32F2F', 5);

                p.fill(211, 47, 47);
                p.noStroke();
                p.textSize(15);
                p.textAlign(p.CENTER);
                p.text("F₁", hingeX + gateThickness/2 + 15 + F1_len/2, F1_y - 10);
                p.textSize(12);
                p.text(forces.F1.toFixed(0) + " kN", hingeX + gateThickness/2 + 15 + F1_len/2, F1_y + 20);

                // F2 - Hydrostatic force on horizontal plate (vertical arrow pointing up)
                let F2_x = hingeX - forces.b2 * scale;
                let F2_len = forces.F2 * forceScale * 0.8;

                drawArrow(F2_x, gateBottom + gateThickness/2 + 5,
                         F2_x, gateBottom + gateThickness/2 + 5 + F2_len, '#D32F2F', 5);

                p.fill(211, 47, 47);
                p.textAlign(p.CENTER);
                p.textSize(15);
                p.text("F₂", F2_x - 30, gateBottom + gateThickness/2 + 25 + F2_len/2);
                p.textSize(12);
                p.text(forces.F2.toFixed(0) + " kN", F2_x - 30, gateBottom + gateThickness/2 + 40 + F2_len/2);

                // P - Applied force (horizontal arrow pointing left to keep gate shut)
                // Arrowhead should touch the external (right) surface of the gate
                let P_len = forces.P * forceScale;

                drawArrow(hingeX + gateThickness/2 + P_len, gateBottom,
                         hingeX + gateThickness/2, gateBottom, '#2E7D32', 5);

                p.fill(46, 125, 50);
                p.textAlign(p.CENTER);
                p.textSize(15);
                p.text("P", hingeX + gateThickness/2 + P_len/2, gateBottom - 10);
                p.textSize(12);
                p.text(forces.P.toFixed(0) + " kN", hingeX + gateThickness/2 + P_len/2, gateBottom + 20);

                // Moment arms (dashed lines)
                p.stroke(100, 100, 180);
                p.strokeWeight(1.5);
                p.drawingContext.setLineDash([4, 4]);

                // b1
                p.line(hingeX, hingeY, hingeX, F1_y);
                p.fill(100, 100, 180);
                p.noStroke();
                p.textSize(11);
                p.text("b₁", hingeX - 20, (hingeY + F1_y)/2);

                // b2
                p.stroke(100, 100, 180);
                p.drawingContext.setLineDash([4, 4]);
                p.line(hingeX, gateBottom, F2_x, gateBottom);
                p.fill(100, 100, 180);
                p.noStroke();
                p.text("b₂", (hingeX + F2_x)/2, gateBottom - 8);

                p.drawingContext.setLineDash([]);
            }

            function drawDimensions() {
                const tankWidth = 5.0; // meters
                let leftWall = hingeX - tankWidth * scale;
                let waterBottom = hingeY + h1 * scale;
                let gateBottom = hingeY + h2 * scale;

                p.stroke(80);
                p.strokeWeight(1);
                p.fill(60);
                p.textSize(12);

                // h1 (water depth)
                let x1 = leftWall - 35;
                drawDimLine(x1, hingeY, x1, waterBottom);
                p.textAlign(p.CENTER);
                p.push();
                p.translate(x1 - 15, (hingeY + waterBottom)/2);
                p.rotate(-p.PI/2);
                p.text("h₁ = " + h1.toFixed(1) + " m", 0, 0);
                p.pop();

                // h2 (gate height)
                let x2 = hingeX + 55;
                drawDimLine(x2, hingeY, x2, gateBottom);
                p.push();
                p.translate(x2 + 20, (hingeY + gateBottom)/2);
                p.rotate(-p.PI/2);
                p.text("h₂ = " + h2.toFixed(1) + " m", 0, 0);
                p.pop();

                // l1 (horizontal plate length)
                let y1 = hingeY - 35;
                drawDimLine(hingeX, y1, hingeX - l1 * scale, y1);
                p.textAlign(p.CENTER);
                p.text("l₁ = " + l1.toFixed(1) + " m", hingeX - l1 * scale/2, y1 - 8);
            }

            function drawDimLine(x1, y1, x2, y2) {
                p.stroke(80);
                p.strokeWeight(1);
                p.line(x1, y1, x2, y2);
                p.line(x1 - 4, y1, x1 + 4, y1);
                p.line(x2 - 4, y2, x2 + 4, y2);
            }

            function drawInfoPanel(forces) {
                p.fill(255, 255, 255, 250);
                p.stroke(100);
                p.strokeWeight(2);
                p.rect(p.width - 310, 15, 295, 235, 8);

                p.fill(0);
                p.noStroke();
                p.textAlign(p.LEFT);
                p.textSize(15);
                p.text("Equilibrium Analysis", p.width - 300, 40);

                p.textSize(11);
                let y = 60;

                p.text("Gate width (perpendicular): b = " + b.toFixed(1) + " m", p.width - 300, y);
                y += 20;

                p.text("Hydrostatic Forces:", p.width - 300, y);
                y += 18;
                p.text("  F₁ = " + forces.F1.toFixed(1) + " kN  (at b₁ = " + forces.b1.toFixed(2) + " m)", p.width - 300, y);
                y += 16;
                p.text("  F₂ = " + forces.F2.toFixed(1) + " kN  (at b₂ = " + forces.b2.toFixed(2) + " m)", p.width - 300, y);
                y += 24;

                p.text("Applied Force:", p.width - 300, y);
                y += 18;
                p.text("  P = " + forces.P.toFixed(1) + " kN", p.width - 300, y);
                y += 24;

                p.text("Moment Balance (about C):", p.width - 300, y);
                y += 18;
                p.text("  F₁·b₁ + F₂·b₂ = P·h₂", p.width - 300, y);
                y += 16;
                p.text("  " + (forces.F1 * forces.b1).toFixed(1) + " + " + (forces.F2 * forces.b2).toFixed(1) +
                       " = " + (forces.P * h2).toFixed(1) + " kN·m", p.width - 300, y);
                y += 24;

                // Status
                p.fill(46, 125, 50);
                p.text("✓ Gate in Equilibrium", p.width - 300, y);
            }

            function drawArrow(x1, y1, x2, y2, color, weight) {
                p.stroke(color);
                p.strokeWeight(weight);
                p.line(x1, y1, x2, y2);

                // Arrowhead - larger for better visibility
                p.fill(color);
                p.noStroke();
                let angle = p.atan2(y2 - y1, x2 - x1);
                let size = 16; // Increased from 10

                p.push();
                p.translate(x2, y2);
                p.rotate(angle);
                p.triangle(0, 0, -size, -size*0.6, -size, size*0.6);
                p.pop();
            }

            function setupControls() {
                document.getElementById("h1").addEventListener("input", function() {
                    h1 = parseFloat(this.value);
                    document.getElementById("h1-value").textContent = h1.toFixed(1);
                    // Update h2 slider max to not exceed h1
                    document.getElementById("h2").max = h1;
                    if (h2 > h1) {
                        h2 = h1;
                        document.getElementById("h2").value = h2;
                        document.getElementById("h2-value").textContent = h2.toFixed(1);
                    }
                });

                document.getElementById("h2").addEventListener("input", function() {
                    h2 = parseFloat(this.value);
                    document.getElementById("h2-value").textContent = h2.toFixed(1);
                });

                document.getElementById("l1").addEventListener("input", function() {
                    l1 = parseFloat(this.value);
                    document.getElementById("l1-value").textContent = l1.toFixed(1);
                });

                // Pressure distribution visualization checkboxes
                document.getElementById("showVerticalPressure").addEventListener("change", function() {
                    showVerticalPressure = this.checked;
                });

                document.getElementById("showHorizontalPressure").addEventListener("change", function() {
                    showHorizontalPressure = this.checked;
                });

                // Set initial max for h2 based on h1
                document.getElementById("h2").max = h1;
            }

        }, 'sketch-holder');

        // Quiz submission
        document.getElementById('submit-quiz').addEventListener('click', function() {
            const answers = {
                q1: 'b',
                q2: 'b',
                q3: 'b',
                q4: 'b',
                q5: 'b'
            };

            let score = 0;
            let totalQuestions = Object.keys(answers).length;
            let resultsHTML = '<h3>Quiz Results:</h3>';

            for (let question in answers) {
                const selectedOption = document.querySelector(`input[name="${question}"]:checked`);
                const correctAnswer = answers[question];

                if (selectedOption) {
                    if (selectedOption.value === correctAnswer) {
                        score++;
                        resultsHTML += `<p style="color: #28a745; font-weight: bold;">${question.toUpperCase()}: Correct! ✓</p>`;
                    } else {
                        resultsHTML += `<p style="color: #dc3545; font-weight: bold;">${question.toUpperCase()}: Incorrect ✗</p>`;
                    }
                } else {
                    resultsHTML += `<p style="color: #666;">${question.toUpperCase()}: Not answered</p>`;
                }
            }

            const percentage = ((score / totalQuestions) * 100).toFixed(0);
            let feedback = "";
            if (percentage >= 80) {
                feedback = "Excellent work! You have a strong understanding of fluid statics.";
            } else if (percentage >= 60) {
                feedback = "Good job! Review the concepts you missed to strengthen your understanding.";
            } else {
                feedback = "Keep studying! Review the lecture content and try the practice problems again.";
            }

            resultsHTML = `<p style="font-size: 1.2em; font-weight: bold;">You scored ${score} out of ${totalQuestions} (${percentage}%)</p><p>${feedback}</p>` + resultsHTML;

            document.getElementById('quiz-results').innerHTML = resultsHTML;
        });
    </script>
</body>
</html>
