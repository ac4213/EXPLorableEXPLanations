<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Truss Analysis - Interactive Lecture</title>

    <!-- External CSS -->
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="stylesheet" href="/assets/css/problems.css">
    <link rel="stylesheet" href="/assets/css/quizzes.css">
    <link rel="stylesheet" href="/assets/css/simulations.css">
    <link rel="stylesheet" href="/assets/css/uicontrols.css">

    <!-- MathJax for LaTeX equations -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-mml-chtml.js"></script>

    <!-- p5.js for interactive simulations -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
</head>

<body>
    <header>
        <h1>Truss Analysis</h1>
        <p class="subtitle">Interactive Lecture & Simulation</p>
    </header>

    <!-- Section 1: Teaching Content -->
    <div class="content-section">
        <h2>Understanding Truss Structures</h2>
        <p>A truss is a structural framework composed of straight members connected at joints (nodes), designed to support loads. Trusses are commonly used in bridges, roofs, and towers because they efficiently transfer loads through axial forces in the members.</p>

        <div class="key-point">
            <p><strong>Core Insight:</strong> In an ideal truss, all members are two-force members experiencing only tension or compression, with no bending moments. This simplification makes structural analysis straightforward and efficient.</p>
        </div>

        <h3>Truss Assumptions</h3>
        <p>For classical truss analysis, we make the following assumptions:</p>
        <ul>
            <li>All members are connected by frictionless pins (no moment transfer at joints)</li>
            <li>All loads are applied at the joints only</li>
            <li>All members are straight and axially loaded (two-force members)</li>
            <li>The weight of members is neglected or applied at joints</li>
        </ul>

        <h3>Method of Joints</h3>
        <p>The Method of Joints is a technique for analyzing trusses by considering the equilibrium of forces at each joint. Since each joint is in equilibrium, the sum of forces in any direction must be zero.</p>

        <div class="equation-box">
            <p><strong>Equilibrium Equations at Each Joint:</strong></p>
            <p>\[\sum F_x = 0\]</p>
            <p>\[\sum F_y = 0\]</p>
            <p>Where:</p>
            <ul>
                <li>\(\sum F_x\) = Sum of horizontal forces (N)</li>
                <li>\(\sum F_y\) = Sum of vertical forces (N)</li>
            </ul>
        </div>

        <h3>Method of Sections</h3>
        <p>The Method of Sections allows us to find forces in specific members without analyzing the entire truss. We make an imaginary cut through the truss, dividing it into two sections, and apply equilibrium equations to one section.</p>

        <div class="equation-box">
            <p><strong>Equilibrium Equations for a Section:</strong></p>
            <p>\[\sum F_x = 0\]</p>
            <p>\[\sum F_y = 0\]</p>
            <p>\[\sum M = 0\]</p>
            <p>Where:</p>
            <ul>
                <li>\(\sum M\) = Sum of moments about any point (N·m)</li>
            </ul>
        </div>

        <h3>Sign Convention</h3>
        <p>In truss analysis, we use the following sign convention:</p>
        <ul>
            <li><strong>Tension (+):</strong> Member is being pulled (elongated)</li>
            <li><strong>Compression (-):</strong> Member is being pushed (shortened)</li>
        </ul>

        <div class="key-point">
            <p><strong>Problem-Solving Strategy:</strong></p>
            <ol>
                <li>Calculate support reactions using global equilibrium</li>
                <li>Identify zero-force members (simplifies analysis)</li>
                <li>Start at a joint with only two unknown forces</li>
                <li>Solve joint equilibrium equations systematically</li>
                <li>Check results by analyzing another joint</li>
            </ol>
        </div>
    </div>

    <!-- Section 2: Interactive Simulation -->
    <div class="simulation-container">
        <h2>Interactive Truss Simulation</h2>
        <p>Adjust the applied load and observe how the member forces change. Members in <span style="color: red; font-weight: bold;">red</span> are in tension, and members in <span style="color: blue; font-weight: bold;">blue</span> are in compression. The thickness of each member represents the magnitude of the force.</p>

        <!-- Control Panel -->
        <div class="controls-panel">
            <div class="controls-grid-2col">
                <div class="slider-container">
                    <label for="load">Applied Load (kN):</label>
                    <div class="slider-row">
                        <input type="range" id="load" min="5" max="50" value="20" step="5">
                        <span id="load-value" class="value-display">20</span>
                    </div>
                </div>
                <div class="slider-container">
                    <label for="span">Truss Span (m):</label>
                    <div class="slider-row">
                        <input type="range" id="span" min="4" max="12" value="8" step="1">
                        <span id="span-value" class="value-display">8</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Canvas Holder -->
        <div id="sketch-holder"></div>

        <!-- Results Panel -->
        <div class="results-panel">
            <p><strong>Maximum Tension:</strong> <span id="max-tension">0</span> kN</p>
            <p><strong>Maximum Compression:</strong> <span id="max-compression">0</span> kN</p>
        </div>

        <!-- Legend -->
        <div class="diagram-legend">
            <div class="legend-item">
                <div class="legend-color" style="background-color: red;"></div>
                <span>Tension</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: blue;"></div>
                <span>Compression</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: black;"></div>
                <span>Zero Force</span>
            </div>
        </div>
    </div>

    <!-- Section 3: Engineering Applications -->
    <div class="content-section">
        <h2>Engineering Applications</h2>
        <ul>
            <li><strong>Bridge Design:</strong> Truss bridges are among the strongest bridge types relative to their weight, using triangulated structures to span long distances efficiently. Examples include the Warren truss and Pratt truss configurations.</li>
            <li><strong>Roof Structures:</strong> Trusses support roofs in buildings, warehouses, and gymnasiums, allowing for large open spaces without interior columns. The triangular configuration distributes loads efficiently to exterior walls.</li>
            <li><strong>Transmission Towers:</strong> Electrical transmission towers use truss configurations to achieve great heights while minimizing material usage and wind resistance.</li>
            <li><strong>Crane Booms:</strong> Tower cranes and mobile cranes use truss structures for their booms, providing high strength-to-weight ratios essential for lifting heavy loads.</li>
            <li><strong>Space Frames:</strong> Three-dimensional truss structures are used in large-span roofs for stadiums, exhibition halls, and airports, creating column-free spaces while distributing loads efficiently.</li>
        </ul>
    </div>

    <!-- Section 4: Summary of Key Equations -->
    <div class="content-section">
        <h2>Summary of Key Equations</h2>
        <div class="equation-table">
            <table>
                <thead>
                    <tr>
                        <th>Concept</th>
                        <th>Equation</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Joint Equilibrium (X)</td>
                        <td>\(\sum F_x = 0\)</td>
                        <td>Sum of horizontal forces at a joint</td>
                    </tr>
                    <tr>
                        <td>Joint Equilibrium (Y)</td>
                        <td>\(\sum F_y = 0\)</td>
                        <td>Sum of vertical forces at a joint</td>
                    </tr>
                    <tr>
                        <td>Force Resolution</td>
                        <td>\(F_x = F \cos\theta\), \(F_y = F \sin\theta\)</td>
                        <td>Resolve member force into components</td>
                    </tr>
                    <tr>
                        <td>Section Equilibrium</td>
                        <td>\(\sum M = 0\)</td>
                        <td>Sum of moments about any point</td>
                    </tr>
                    <tr>
                        <td>Member Count Check</td>
                        <td>\(m = 2j - 3\)</td>
                        <td>For a stable, determinate truss (m=members, j=joints)</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Section 5: Practice Problems -->
    <div class="content-section">
        <h2>Practice Problems</h2>

        <div class="practice-problems">
            <h3>Problem 1: Simple Warren Truss</h3>
            <p>A Warren truss has a span of 6 m and height of 2 m. A downward load of 10 kN is applied at the center top joint. The truss is supported by a pin at the left end and a roller at the right end. Find the force in the top horizontal member.</p>

            <p class="toggle-section" onclick="toggleSolution('solution1')">Show Solution</p>
            <div id="solution1" class="hidden">
                <p><strong>Solution:</strong></p>
                <p><strong>Step 1: Calculate Support Reactions</strong></p>
                <p>By symmetry, each support carries 5 kN vertically.</p>
                <p>\[R_A = R_B = \frac{10}{2} = 5 \text{ kN}\]</p>

                <p><strong>Step 2: Analyze the Center Top Joint</strong></p>
                <p>At the center joint, the applied load is 10 kN downward. Two diagonal members connect to the supports, and one horizontal member on each side.</p>
                <p>The angle of the diagonal members: \(\theta = \arctan(2/3) = 33.69°\)</p>

                <p><strong>Step 3: Vertical Equilibrium</strong></p>
                <p>Two diagonal members carry the load symmetrically:</p>
                <p>\[2F_{\text{diagonal}} \sin\theta = 10\]</p>
                <p>\[F_{\text{diagonal}} = \frac{10}{2 \times \sin(33.69°)} = \frac{10}{1.11} = 9.01 \text{ kN (Compression)}\]</p>

                <p><strong>Step 4: Horizontal Equilibrium</strong></p>
                <p>The horizontal member must balance the horizontal components:</p>
                <p>\[F_{\text{horizontal}} = 2F_{\text{diagonal}} \cos\theta = 2 \times 9.01 \times \cos(33.69°) = 15.0 \text{ kN (Tension)}\]</p>

                <p><strong>Answer:</strong> The top horizontal member carries 15.0 kN in tension.</p>
            </div>
        </div>

        <div class="practice-problems">
            <h3>Problem 2: Method of Sections</h3>
            <p>For a Pratt truss with 8 m span and 2 m height, a 12 kN load is applied at the top left quarter point. Using the method of sections, find the force in the center vertical member.</p>

            <p class="toggle-section" onclick="toggleSolution('solution2')">Show Solution</p>
            <div id="solution2" class="hidden">
                <p><strong>Solution:</strong></p>
                <p><strong>Step 1: Calculate Support Reactions</strong></p>
                <p>Taking moments about the right support:</p>
                <p>\[R_A \times 8 = 12 \times 6\]</p>
                <p>\[R_A = 9 \text{ kN}\]</p>
                <p>\[R_B = 12 - 9 = 3 \text{ kN}\]</p>

                <p><strong>Step 2: Make a Section Cut</strong></p>
                <p>Cut through the center vertical member and the two diagonal members adjacent to it.</p>

                <p><strong>Step 3: Take Moments About Intersection Point</strong></p>
                <p>Choose the point where the two diagonals intersect (eliminates two unknowns).</p>
                <p>Taking moments about this point and considering the left section:</p>
                <p>\[R_A \times 4 - 12 \times 2 - F_{\text{vertical}} \times 0 = 0\]</p>
                <p>Wait, we need to choose a better moment point.</p>

                <p>Taking moments about the top left joint of the section:</p>
                <p>\[R_A \times 4 - F_{\text{vertical}} \times 4 = 0\]</p>
                <p>\[F_{\text{vertical}} = R_A = 9 \text{ kN (Tension)}\]</p>

                <p><strong>Answer:</strong> The center vertical member carries 9 kN in tension.</p>
            </div>
        </div>

        <div class="practice-problems">
            <h3>Problem 3: Zero-Force Members</h3>
            <p>Identify the zero-force members in a truss where a joint has three members: two are collinear (in a straight line), and the third is at an angle. No external loads are applied at this joint.</p>

            <p class="toggle-section" onclick="toggleSolution('solution3')">Show Solution</p>
            <div id="solution3" class="hidden">
                <p><strong>Solution:</strong></p>
                <p><strong>Zero-Force Member Rules:</strong></p>
                <ul>
                    <li>If two members form a truss joint and no external force is applied, both members are zero-force members.</li>
                    <li>If three members form a truss joint and two are collinear, the third member is a zero-force member (if no external force is applied).</li>
                </ul>

                <p><strong>Analysis:</strong></p>
                <p>At the described joint, two members are collinear. For equilibrium in the direction perpendicular to these collinear members, the force in the third member must be zero.</p>

                <p><strong>Mathematical Proof:</strong></p>
                <p>Let the collinear members be along the x-axis. For vertical equilibrium:</p>
                <p>\[\sum F_y = F_3 \sin\theta = 0\]</p>
                <p>Since \(\sin\theta \neq 0\) (the member is at an angle), we must have \(F_3 = 0\).</p>

                <p><strong>Answer:</strong> The non-collinear member is a zero-force member.</p>
            </div>
        </div>
    </div>

    <!-- Section 6: Knowledge Check Quiz -->
    <div class="content-section">
        <h2>Knowledge Check Quiz</h2>
        <div class="quiz-container">
            <div class="quiz-question">
                <h3>Question 1: In truss analysis, what assumption is made about the joints?</h3>
                <div class="quiz-options">
                    <label><input type="radio" name="q1" value="a"> a) Joints are rigid and transfer moments</label>
                    <label><input type="radio" name="q1" value="b"> b) Joints are frictionless pins with no moment transfer</label>
                    <label><input type="radio" name="q1" value="c"> c) Joints are welded connections</label>
                    <label><input type="radio" name="q1" value="d"> d) Joints can rotate freely under any load</label>
                </div>
            </div>

            <div class="quiz-question">
                <h3>Question 2: A truss member in compression is:</h3>
                <div class="quiz-options">
                    <label><input type="radio" name="q2" value="a"> a) Being pulled and elongated</label>
                    <label><input type="radio" name="q2" value="b"> b) Being pushed and shortened</label>
                    <label><input type="radio" name="q2" value="c"> c) Experiencing zero force</label>
                    <label><input type="radio" name="q2" value="d"> d) Bending under load</label>
                </div>
            </div>

            <div class="quiz-question">
                <h3>Question 3: The Method of Joints is most efficient when:</h3>
                <div class="quiz-options">
                    <label><input type="radio" name="q3" value="a"> a) You need forces in all members</label>
                    <label><input type="radio" name="q3" value="b"> b) You need force in only one specific member</label>
                    <label><input type="radio" name="q3" value="c"> c) The truss has many zero-force members</label>
                    <label><input type="radio" name="q3" value="d"> d) Analyzing a three-dimensional truss</label>
                </div>
            </div>

            <div class="quiz-question">
                <h3>Question 4: For a statically determinate plane truss with j joints and m members:</h3>
                <div class="quiz-options">
                    <label><input type="radio" name="q4" value="a"> a) m = j - 3</label>
                    <label><input type="radio" name="q4" value="b"> b) m = 2j - 3</label>
                    <label><input type="radio" name="q4" value="c"> c) m = 2j + 3</label>
                    <label><input type="radio" name="q4" value="d"> d) m = 3j - 2</label>
                </div>
            </div>

            <div class="quiz-question">
                <h3>Question 5: When using the Method of Sections, you can cut through a maximum of:</h3>
                <div class="quiz-options">
                    <label><input type="radio" name="q5" value="a"> a) 2 members</label>
                    <label><input type="radio" name="q5" value="b"> b) 3 members</label>
                    <label><input type="radio" name="q5" value="c"> c) 4 members</label>
                    <label><input type="radio" name="q5" value="d"> d) Any number of members</label>
                </div>
            </div>

            <button id="submit-quiz">Submit Quiz</button>
            <div id="quiz-results"></div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <script src="/assets/common/footer.js"></script>
    </footer>

    <!-- Common JavaScript Functions -->
    <script src="/assets/common/problems.js"></script>
    <script src="/assets/common/quizzes.js"></script>

    <!-- Page-specific JavaScript -->
    <script>
        // Truss simulation using p5.js
        let sketch = new p5(function(p) {
            let load = 20; // kN
            let span = 8; // m
            let height = 2; // m
            let scale = 40; // pixels per meter

            // Truss geometry
            let nodes = [];
            let members = [];
            let memberForces = [];

            p.setup = function() {
                let canvasWidth = Math.min(800, p.windowWidth - 40);
                p.createCanvas(canvasWidth, 400);
                setupControls();
                calculateTruss();
            };

            p.draw = function() {
                p.background(240);
                p.translate(50, 300);

                // Draw supports
                drawSupports();

                // Draw members
                drawMembers();

                // Draw nodes
                drawNodes();

                // Draw load
                drawLoad();
            };

            function setupControls() {
                document.getElementById("load").addEventListener("input", function() {
                    load = parseFloat(this.value);
                    document.getElementById("load-value").textContent = load;
                    calculateTruss();
                });

                document.getElementById("span").addEventListener("input", function() {
                    span = parseFloat(this.value);
                    document.getElementById("span-value").textContent = span;
                    calculateTruss();
                });
            }

            function calculateTruss() {
                // Simple Warren truss with center load
                nodes = [
                    {x: 0, y: 0},           // 0: left support
                    {x: span/2, y: -height}, // 1: center top
                    {x: span, y: 0}          // 2: right support
                ];

                // Calculate member forces
                // For a simple 3-node Warren truss with center load
                let theta = Math.atan2(height, span/2);
                let diagonalForce = load / (2 * Math.sin(theta));
                let horizontalForce = diagonalForce * Math.cos(theta);

                memberForces = [
                    -diagonalForce,  // Member 0-1 (compression)
                    -diagonalForce,  // Member 1-2 (compression)
                    horizontalForce  // Member 0-2 (tension)
                ];

                members = [
                    {start: 0, end: 1, force: memberForces[0]},
                    {start: 1, end: 2, force: memberForces[1]},
                    {start: 0, end: 2, force: memberForces[2]}
                ];

                updateResults();
            }

            function drawSupports() {
                // Left pin support
                p.fill(100);
                p.noStroke();
                p.triangle(
                    nodes[0].x * scale - 10, nodes[0].y * scale,
                    nodes[0].x * scale + 10, nodes[0].y * scale,
                    nodes[0].x * scale, nodes[0].y * scale + 15
                );

                // Right roller support
                p.triangle(
                    nodes[2].x * scale - 10, nodes[2].y * scale,
                    nodes[2].x * scale + 10, nodes[2].y * scale,
                    nodes[2].x * scale, nodes[2].y * scale + 15
                );
                p.ellipse(nodes[2].x * scale, nodes[2].y * scale + 20, 10, 10);
            }

            function drawMembers() {
                for (let member of members) {
                    let startNode = nodes[member.start];
                    let endNode = nodes[member.end];

                    // Color based on tension/compression
                    if (Math.abs(member.force) < 0.1) {
                        p.stroke(0);
                        p.strokeWeight(2);
                    } else if (member.force > 0) {
                        p.stroke(255, 0, 0); // Tension - red
                        p.strokeWeight(p.map(Math.abs(member.force), 0, load * 2, 2, 8));
                    } else {
                        p.stroke(0, 0, 255); // Compression - blue
                        p.strokeWeight(p.map(Math.abs(member.force), 0, load * 2, 2, 8));
                    }

                    p.line(
                        startNode.x * scale, startNode.y * scale,
                        endNode.x * scale, endNode.y * scale
                    );

                    // Draw force magnitude
                    let midX = (startNode.x + endNode.x) / 2 * scale;
                    let midY = (startNode.y + endNode.y) / 2 * scale;
                    p.noStroke();
                    p.fill(0);
                    p.textAlign(p.CENTER);
                    p.textSize(10);
                    p.text(Math.abs(member.force).toFixed(1) + " kN", midX, midY - 5);
                }
            }

            function drawNodes() {
                p.fill(0);
                p.noStroke();
                for (let node of nodes) {
                    p.ellipse(node.x * scale, node.y * scale, 8, 8);
                }
            }

            function drawLoad() {
                // Draw load arrow at center top
                let centerNode = nodes[1];
                p.stroke(255, 150, 0);
                p.strokeWeight(3);
                p.fill(255, 150, 0);

                // Arrow line
                p.line(
                    centerNode.x * scale, centerNode.y * scale - 40,
                    centerNode.x * scale, centerNode.y * scale
                );

                // Arrow head
                p.triangle(
                    centerNode.x * scale, centerNode.y * scale,
                    centerNode.x * scale - 5, centerNode.y * scale - 10,
                    centerNode.x * scale + 5, centerNode.y * scale - 10
                );

                // Load label
                p.noStroke();
                p.fill(0);
                p.textAlign(p.CENTER);
                p.text(load + " kN", centerNode.x * scale, centerNode.y * scale - 45);
            }

            function updateResults() {
                let maxTension = Math.max(...memberForces.filter(f => f > 0), 0);
                let maxCompression = Math.min(...memberForces.filter(f => f < 0), 0);

                document.getElementById("max-tension").textContent = maxTension.toFixed(2);
                document.getElementById("max-compression").textContent = Math.abs(maxCompression).toFixed(2);
            }

        }, 'sketch-holder');

        // Quiz submission
        document.getElementById('submit-quiz').addEventListener('click', function() {
            const answers = {
                q1: 'b',
                q2: 'b',
                q3: 'a',
                q4: 'b',
                q5: 'b'
            };

            let score = 0;
            let totalQuestions = Object.keys(answers).length;
            let resultsHTML = '<h3>Quiz Results:</h3>';

            for (let question in answers) {
                const selectedOption = document.querySelector(`input[name="${question}"]:checked`);
                const correctAnswer = answers[question];

                if (selectedOption) {
                    if (selectedOption.value === correctAnswer) {
                        score++;
                        resultsHTML += `<p style="color: #28a745; font-weight: bold;">${question.toUpperCase()}: Correct! ✓</p>`;
                    } else {
                        resultsHTML += `<p style="color: #dc3545; font-weight: bold;">${question.toUpperCase()}: Incorrect ✗</p>`;
                    }
                } else {
                    resultsHTML += `<p style="color: #666;">${question.toUpperCase()}: Not answered</p>`;
                }
            }

            const percentage = ((score / totalQuestions) * 100).toFixed(0);
            let feedback = "";
            if (percentage >= 80) {
                feedback = "Excellent work! You have a strong understanding of truss analysis.";
            } else if (percentage >= 60) {
                feedback = "Good job! Review the concepts you missed to strengthen your understanding.";
            } else {
                feedback = "Keep studying! Review the lecture content and try the practice problems again.";
            }

            resultsHTML = `<p style="font-size: 1.2em; font-weight: bold;">You scored ${score} out of ${totalQuestions} (${percentage}%)</p><p>${feedback}</p>` + resultsHTML;

            document.getElementById('quiz-results').innerHTML = resultsHTML;
        });
    </script>
</body>
</html>
